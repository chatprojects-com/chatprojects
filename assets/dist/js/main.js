import{m as e}from"./alpine-core-B3GESKiv.js";/* empty css             */import{t,i as a}from"./index-DWuNdYZ9.js";import"./chat.js";import"./vendor-highlight-DerHs5y0.js";import"./vendor-markdown-C9lje_HT.js";class i{constructor(){this.theme=this.getStoredTheme()||this.getSystemTheme(),this.init()}init(){this.applyTheme(this.theme),this.setupListeners()}getStoredTheme(){return localStorage.getItem("cp_theme_preference")}getSystemTheme(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}applyTheme(e){const t=document.documentElement;"dark"===e?t.classList.add("dark"):t.classList.remove("dark"),this.theme=e,localStorage.setItem("cp_theme_preference",e),window.dispatchEvent(new CustomEvent("vp:theme:changed",{detail:{theme:e}}))}toggle(){const e="dark"===this.theme?"light":"dark";return this.applyTheme(e),e}setTheme(e){"dark"!==e&&"light"!==e||this.applyTheme(e)}setupListeners(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{this.getStoredTheme()||this.applyTheme(e.matches?"dark":"light")})}getCurrentTheme(){return this.theme}}let s=null;class o{constructor(){this.shortcuts=new Map,this.isEnabled=!0,this.init()}init(){this.registerDefaultShortcuts(),this.setupListeners()}registerDefaultShortcuts(){this.register("mod+k",()=>{this.openCommandPalette()},"Open command palette"),this.register("mod+n",()=>{window.dispatchEvent(new CustomEvent("vp:chat:new"))},"Start new chat"),this.register("mod+shift+l",()=>{var e;null==(e=window.VPTheme)||e.toggle()},"Toggle light/dark mode"),this.register("mod+/",()=>{const e=document.querySelector("[data-search-input]");e&&e.focus()},"Focus search"),this.register("?",()=>{this.showShortcutsModal()},"Show keyboard shortcuts"),this.register("escape",()=>{window.dispatchEvent(new CustomEvent("vp:modal:close"))},"Close modal/dialog")}register(e,t,a=""){this.shortcuts.set(e,{callback:t,description:a,keys:this.parseKeyCombination(e)})}parseKeyCombination(e){return e.toLowerCase().split("+").map(e=>"mod"===e?navigator.platform.includes("Mac")?"meta":"ctrl":e)}setupListeners(){document.addEventListener("keydown",e=>{if(!this.isEnabled)return;const t=["INPUT","TEXTAREA","SELECT"].includes(e.target.tagName),a=e.target.isContentEditable;if(t||a){if("Escape"===e.key)return void e.target.blur();if("?"!==e.key)return}this.shortcuts.forEach((t,a)=>{this.matchesShortcut(e,t.keys)&&(e.preventDefault(),t.callback(e))})})}matchesShortcut(e,t){const a=[];e.ctrlKey&&a.push("ctrl"),e.metaKey&&a.push("meta"),e.shiftKey&&a.push("shift"),e.altKey&&a.push("alt");const i=e.key.toLowerCase();return["control","meta","shift","alt"].includes(i)||a.push(i),a.length===t.length&&t.every(e=>a.includes(e))}openCommandPalette(){window.dispatchEvent(new CustomEvent("vp:command-palette:open"))}showShortcutsModal(){const e=Array.from(this.shortcuts.entries()).map(([e,t])=>({combination:this.formatCombination(e),description:t.description}));window.dispatchEvent(new CustomEvent("vp:shortcuts:show",{detail:{shortcuts:e}}))}formatCombination(e){const t=navigator.platform.includes("Mac");return e.replace("mod",t?"⌘":"Ctrl").replace("shift",t?"⇧":"Shift").replace("alt",t?"⌥":"Alt").replace("ctrl",t?"⌃":"Ctrl").split("+").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(t?" ":" + ")}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}unregister(e){this.shortcuts.delete(e)}getShortcuts(){return Array.from(this.shortcuts.entries()).map(([e,t])=>({combination:this.formatCombination(e),description:t.description}))}}let r=null;document.addEventListener("alpine:init",()=>{window.Alpine.data("sidebar",()=>({isOpen:!0,isMobile:window.innerWidth<768,init(){this.isMobile&&(this.isOpen=!1),window.addEventListener("resize",()=>{const e=this.isMobile;this.isMobile=window.innerWidth<768,!e&&this.isMobile?this.isOpen=!1:e&&!this.isMobile&&(this.isOpen=!0)})},toggle(){this.isOpen=!this.isOpen},close(){this.isOpen=!1},open(){this.isOpen=!0}}))}),document.addEventListener("alpine:init",()=>{window.Alpine.data("projectSwitcher",(e=null)=>({isOpen:!1,searchQuery:"",currentProjectId:e,projects:[],loading:!1,init(){this.loadProjects(),document.addEventListener("click",e=>{this.$el.contains(e.target)||(this.isOpen=!1)})},async loadProjects(){this.loading=!0;try{const e=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_get_projects",nonce:chatprData.nonce})}),t=await e.json();t.success&&(this.projects=t.data)}catch(e){console.error("Failed to load projects:",e)}finally{this.loading=!1}},get filteredProjects(){if(!this.searchQuery)return this.projects;const e=this.searchQuery.toLowerCase();return this.projects.filter(t=>t.title.toLowerCase().includes(e))},selectProject(e){window.location.href=`?page=chatprojects&project_id=${e}`},toggle(){this.isOpen=!this.isOpen,this.isOpen&&this.$nextTick(()=>{var e;null==(e=this.$refs.searchInput)||e.focus()})},openShareModal(){this.isOpen=!1,window.dispatchEvent(new CustomEvent("open-share-modal"))}}))}),document.addEventListener("alpine:init",()=>{window.Alpine.data("modal",(e=!1)=>({isOpen:e,init(){window.addEventListener("vp:modal:open",e=>{var t;(null==(t=e.detail)?void 0:t.id)===this.$el.id&&this.open()}),window.addEventListener("vp:modal:close",()=>{this.close()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.isOpen&&this.close()})},open(){this.isOpen=!0,document.body.style.overflow="hidden",this.$nextTick(()=>{const e=this.$el.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');e.length&&e[0].focus()})},close(){this.isOpen=!1,document.body.style.overflow=""},closeOnBackdrop(e){e.target===e.currentTarget&&this.close()}}))}),document.addEventListener("alpine:init",()=>{window.Alpine.data("dropdown",(e="bottom-left")=>({isOpen:!1,placement:e,init(){document.addEventListener("click",e=>{!this.$el.contains(e.target)&&this.isOpen&&(this.isOpen=!1)}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.isOpen&&(this.isOpen=!1)})},toggle(){this.isOpen=!this.isOpen},close(){this.isOpen=!1},open(){this.isOpen=!0}}))}),document.addEventListener("alpine:init",()=>{window.Alpine.data("chatHistory",(e=null,a=null)=>({projectId:e,chatMode:a,chats:[],activeThreadId:null,loading:!1,editingChatId:null,editingTitle:"",init(){this.loadChatList(),window.addEventListener("vp:chat:updated",e=>{this.loadChatList(),e.detail&&e.detail.threadId&&(this.activeThreadId=e.detail.threadId)}),window.addEventListener("vp:chat:new",()=>{this.activeThreadId=null}),window.addEventListener("vp:chat:switch",e=>{e.detail&&e.detail.threadId&&(this.activeThreadId=e.detail.threadId)})},async loadChatList(){var e;this.loading=!0;try{const a={action:"chatpr_get_chat_list",nonce:chatprData.nonce,project_id:this.projectId||""};this.chatMode&&(a.chat_mode=this.chatMode);const i=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(a)}),s=await i.json();if(s.success)this.chats=s.data.chats||[];else{console.error("Failed to load chat list:",s.data);const a="string"==typeof s.data?s.data:(null==(e=s.data)?void 0:e.message)||"Failed to load chat history";t(a,"error")}}catch(a){console.error("Error loading chat list:",a),t("Failed to load chat history","error")}finally{this.loading=!1}},switchChat(e){this.activeThreadId=e,window.dispatchEvent(new CustomEvent("vp:chat:switch",{detail:{threadId:e}}))},startEditingChat(e,t){t.stopPropagation(),this.editingChatId=e.id,this.editingTitle=e.title||e.first_message||"Untitled Chat"},cancelEditing(){this.editingChatId=null,this.editingTitle=""},async saveTitle(e,a){var i;if(a.stopPropagation(),this.editingTitle.trim()){try{const a=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_rename_chat",nonce:chatprData.nonce,chat_id:e,title:this.editingTitle.trim()})}),s=await a.json();if(s.success)t("Chat renamed successfully","success",2e3),this.loadChatList();else{const e="string"==typeof s.data?s.data:(null==(i=s.data)?void 0:i.message)||"Failed to rename chat";console.error("Rename failed:",e,s),t(e,"error")}}catch(s){console.error("Error renaming chat:",s),t("Failed to rename chat","error")}finally{this.cancelEditing()}}else t("Chat title cannot be empty","error")},async deleteChat(e,a){var i;if(a.stopPropagation(),confirm("Are you sure you want to delete this chat? This action cannot be undone.")){try{const a=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_delete_chat",nonce:chatprData.nonce,chat_id:e})}),s=await a.json();if(s.success)t("Chat deleted successfully","success",2e3),this.activeThreadId===e&&(this.activeThreadId=null,window.dispatchEvent(new CustomEvent("vp:chat:new"))),this.loadChatList();else{const e="string"==typeof s.data?s.data:(null==(i=s.data)?void 0:i.message)||"Failed to delete chat";console.error("Delete failed:",e,s),t(e,"error")}}catch(s){console.error("Error deleting chat:",s),t("Failed to delete chat","error")}}},formatDate(e){if(!e)return"";const t=new Date(e),a=new Date,i=Math.abs(a-t),s=Math.floor(i/864e5);return 0===s?"Today":1===s?"Yesterday":s<7?`${s} days ago`:t.toLocaleDateString()},getChatTitle:e=>e.title||e.first_message||"Untitled Chat",truncateText:(e,t=40)=>e?e.length>t?e.substring(0,t)+"...":e:"",getDateGroup(e){if(!e)return"Older";const t=new Date(e),a=new Date,i=Math.abs(a-t),s=Math.floor(i/864e5);return 0===s?"Today":1===s?"Yesterday":s<7?"Last 7 Days":s<30?"Last 30 Days":"Older"},get groupedChats(){const e={};this.chats.forEach(t=>{const a=this.getDateGroup(t.updated_at);e[a]||(e[a]=[]),e[a].push(t)});const t=[];return["Today","Yesterday","Last 7 Days","Last 30 Days","Older"].forEach(a=>{e[a]&&e[a].length>0&&t.push({name:a,chats:e[a]})}),t}}))}),document.addEventListener("alpine:init",()=>{window.Alpine.data("fileManager",(e=null)=>({projectId:e,files:[],loading:!1,uploading:!1,uploadQueue:[],selectedFiles:[],selectAll:!1,isDragging:!1,init(){this.loadFiles(),this.$watch("selectAll",e=>{this.selectedFiles=e?this.files.map(e=>e.id||e.file_id):[]}),this.$watch("selectedFiles",()=>{0===this.selectedFiles.length?this.selectAll=!1:this.selectedFiles.length===this.files.length&&this.files.length>0&&(this.selectAll=!0)})},async loadFiles(){this.loading=!0;try{const e=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_list_files",nonce:chatprData.nonce,project_id:this.projectId||""})}),t=await e.json();t.success?this.files=t.data.files||[]:console.error("Failed to load files:",t.data)}catch(e){console.error("Error loading files:",e)}finally{this.loading=!1}},handleFileSelect(e){const t=e.target.files;t&&t.length>0&&this.handleFiles(Array.from(t)),e.target.value=""},handleDrop(e){var t;e.preventDefault(),this.isDragging=!1;const a=null==(t=e.dataTransfer)?void 0:t.files;a&&a.length>0&&this.handleFiles(Array.from(a))},handleDragOver(e){e.preventDefault(),this.isDragging=!0},handleDragLeave(e){e.preventDefault(),this.isDragging=!1},handleFiles(e){e.forEach(e=>{this.validateFile(e)&&this.uploadFile(e)})},validateFile(e){if(e.size>52428800)return t(`File "${e.name}" exceeds 50MB limit`,"error"),!1;return!(!["application/pdf","text/plain","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/csv","application/json","text/markdown","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type)&&!e.name.endsWith(".md"))||(t(`File type "${e.type}" is not allowed`,"error"),!1)},async uploadFile(e){var a;const i="upload-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),s={id:i,name:e.name,progress:0,status:"uploading"};this.uploadQueue.push(s);const o=new FormData;o.append("action","chatpr_upload_file"),o.append("nonce",chatprData.nonce),o.append("project_id",this.projectId||""),o.append("file",e);try{const s=new XMLHttpRequest;s.upload.addEventListener("progress",e=>{if(e.lengthComputable){const t=e.loaded/e.total*100,a=this.uploadQueue.find(e=>e.id===i);a&&(a.progress=t)}});const r=new Promise((e,t)=>{s.onload=()=>{if(200===s.status)try{const t=JSON.parse(s.responseText);e(t)}catch(a){t(new Error("Invalid JSON response"))}else t(new Error(`HTTP ${s.status}`))},s.onerror=()=>t(new Error("Network error"))});s.open("POST",chatprData.ajax_url),s.send(o);const n=await r;if(n.success){const a=this.uploadQueue.find(e=>e.id===i);a&&(a.status="success",a.progress=100),t(`File "${e.name}" uploaded successfully`,"success",3e3),this.files.unshift(n.data.file),setTimeout(()=>{this.uploadQueue=this.uploadQueue.filter(e=>e.id!==i)},2e3)}else{const e=this.uploadQueue.find(e=>e.id===i);e&&(e.status="error");const s=(null==(a=n.data)?void 0:a.message)||"Failed to upload file";t(s,"error"),setTimeout(()=>{this.uploadQueue=this.uploadQueue.filter(e=>e.id!==i)},3e3)}}catch(r){const a=this.uploadQueue.find(e=>e.id===i);a&&(a.status="error"),console.error("Upload error:",r),t(`Failed to upload "${e.name}"`,"error"),setTimeout(()=>{this.uploadQueue=this.uploadQueue.filter(e=>e.id!==i)},3e3)}},async deleteFile(e){var a;if(confirm("Are you sure you want to delete this file? This action cannot be undone."))try{const i=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_delete_file",nonce:chatprData.nonce,file_id:e,project_id:this.projectId||""})}),s=await i.json();s.success?(t("File deleted successfully","success",2e3),this.files=this.files.filter(t=>(t.id||t.file_id)!==e),this.selectedFiles=this.selectedFiles.filter(t=>t!==e)):t((null==(a=s.data)?void 0:a.message)||"Failed to delete file","error")}catch(i){console.error("Error deleting file:",i),t("Failed to delete file","error")}},async bulkDeleteFiles(){const e=this.selectedFiles.length;if(0===e)return;if(!confirm(`Are you sure you want to delete ${e} file${e>1?"s":""}? This action cannot be undone.`))return;const a=[...this.selectedFiles];let i=0,s=0;for(const t of a)try{const e=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_delete_file",nonce:chatprData.nonce,file_id:t,project_id:this.projectId||""})});(await e.json()).success?(i++,this.files=this.files.filter(e=>(e.id||e.file_id)!==t)):s++}catch(o){console.error("Error deleting file:",o),s++}this.selectedFiles=[],this.selectAll=!1,i>0&&t(`${i} file${i>1?"s":""} deleted successfully`,"success"),s>0&&t(`Failed to delete ${s} file${s>1?"s":""}`,"error")},formatFileSize(e){if(!e||0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]},formatDate(e){if(!e)return"";const t=new Date(e),a=new Date,i=Math.abs(a-t),s=Math.floor(i/864e5);return 0===s?"Today at "+t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):1===s?"Yesterday":s<7?`${s} days ago`:t.toLocaleDateString()},getFileId:e=>e.id||e.file_id,getFileSize:e=>e.bytes||e.size||0,getFileDate:e=>e.created_at||e.uploaded_at||"",triggerFileInput(){this.$refs.fileInput.click()}}))}),document.addEventListener("alpine:init",()=>{window.Alpine.data("transcriber",(e=null)=>({projectId:e,selectedFile:null,language:"",enableRewrite:!1,tone:"",transcribing:!1,rewriting:!1,saving:!1,transcription:null,rewrittenText:null,duration:null,saveToDatabase:!1,init(){},handleFileSelect(e){var t;const a=null==(t=e.target.files)?void 0:t[0];a&&this.selectFile(a)},handleDrop(e){var t,a;e.preventDefault();const i=null==(a=null==(t=e.dataTransfer)?void 0:t.files)?void 0:a[0];i&&this.selectFile(i)},selectFile(e){if(!(["audio/mpeg","audio/mp4","audio/wav","audio/m4a","audio/webm","video/mp4","video/webm"].includes(e.type)||e.name.match(/\.(mp3|mp4|wav|m4a|webm)$/i)))return void t("Please select a valid audio or video file","error");e.size>26214400?t("File size exceeds 25MB limit","error"):(this.selectedFile=e,this.transcription=null,this.rewrittenText=null,this.duration=null)},clearFile(){this.selectedFile=null,this.transcription=null,this.rewrittenText=null,this.duration=null},async transcribe(){var e;if(!this.selectedFile)return void t("Please select an audio file first","error");this.transcribing=!0;const a=new FormData;a.append("action","chatpr_transcribe_audio"),a.append("nonce",chatprData.nonce),a.append("project_id",this.projectId||""),a.append("audio_file",this.selectedFile),this.language&&a.append("language",this.language);try{const i=await fetch(chatprData.ajax_url,{method:"POST",body:a}),s=await i.json();s.success?(this.transcription=s.data.text||s.data.transcription,this.duration=s.data.duration,t("Transcription completed successfully","success",3e3),this.enableRewrite&&this.tone&&setTimeout(()=>this.rewrite(),500)):t((null==(e=s.data)?void 0:e.message)||"Transcription failed","error")}catch(i){console.error("Transcription error:",i),t("Failed to transcribe audio","error")}finally{this.transcribing=!1}},async rewrite(){var e;if(this.transcription)if(this.tone){this.rewriting=!0;try{const a=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_rewrite_transcription",nonce:chatprData.nonce,transcription:this.transcription,tone:this.tone,project_id:this.projectId||""})}),i=await a.json();i.success?(this.rewrittenText=i.data.rewritten_text||i.data.text,t("Text rewritten successfully","success",2e3)):t((null==(e=i.data)?void 0:e.message)||"Rewrite failed","error")}catch(a){console.error("Rewrite error:",a),t("Failed to rewrite text","error")}finally{this.rewriting=!1}}else t("Please select a tone for rewriting","error");else t("No transcription available to rewrite","error")},async saveTranscription(){var e,a;if(this.transcription){this.saving=!0;try{const i=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_save_transcription",nonce:chatprData.nonce,project_id:this.projectId||"",transcription:this.transcription,rewritten:this.rewrittenText||"",file_name:(null==(e=this.selectedFile)?void 0:e.name)||"transcription.txt",duration:this.duration||"",language:this.language||"",save_to_db:this.saveToDatabase?"1":"0"})}),s=await i.json();s.success?(t("Transcription saved successfully","success",3e3),setTimeout(()=>{this.clearFile(),this.saveToDatabase=!1,this.tone=""},1e3)):t((null==(a=s.data)?void 0:a.message)||"Failed to save transcription","error")}catch(i){console.error("Save error:",i),t("Failed to save transcription","error")}finally{this.saving=!1}}else t("No transcription available to save","error")},async saveToProject(){var e,a,i;if(!this.transcription)return void t("No transcription available to save","error");if(!this.projectId)return void t("No project selected","error");this.saving=!0;const s=this.rewrittenText||this.transcription,o=`${(null==(a=null==(e=this.selectedFile)?void 0:e.name)?void 0:a.replace(/\.[^/.]+$/,""))||"transcription"}_transcription.txt`;try{const e=new Blob([s],{type:"text/plain"}),a=new File([e],o,{type:"text/plain"}),r=new FormData;r.append("action","chatpr_upload_file"),r.append("nonce",chatprData.nonce),r.append("project_id",this.projectId),r.append("file",a);const n=await fetch(chatprData.ajax_url,{method:"POST",body:r}),l=await n.json();l.success?(t("Transcription saved to project successfully","success",3e3),setTimeout(()=>{this.clearFile(),this.tone=""},1e3)):t((null==(i=l.data)?void 0:i.message)||"Failed to save to project","error")}catch(r){console.error("Save to project error:",r),t("Failed to save to project","error")}finally{this.saving=!1}},copyText(e){navigator.clipboard.writeText(e).then(()=>{t("Copied to clipboard","success",2e3)}).catch(()=>{t("Failed to copy to clipboard","error")})},formatFileSize(e){if(!e||0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]},formatDuration(e){if(!e)return"";return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`},triggerFileInput(){this.$refs.fileInput.click()}}))}),document.addEventListener("alpine:init",()=>{window.Alpine.data("promptLibrary",(e=null)=>({projectId:e,prompts:[],filteredPrompts:[],loading:!1,searchQuery:"",categoryFilter:"",showModal:!1,editingPrompt:null,formData:{title:"",content:"",category:"general"},saving:!1,enhancing:!1,init(){this.loadPrompts(),this.$watch("searchQuery",()=>this.filterPrompts()),this.$watch("categoryFilter",()=>this.filterPrompts())},async loadPrompts(){this.loading=!0;try{const e=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_list_prompts",nonce:chatprData.nonce,project_id:this.projectId||""})}),t=await e.json();t.success?(this.prompts=t.data.prompts||[],this.filterPrompts()):console.error("Failed to load prompts:",t.data)}catch(e){console.error("Error loading prompts:",e),t("Failed to load prompts","error")}finally{this.loading=!1}},filterPrompts(){let e=[...this.prompts];if(this.searchQuery.trim()){const t=this.searchQuery.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(t)||e.content.toLowerCase().includes(t))}this.categoryFilter&&(e=e.filter(e=>e.category===this.categoryFilter)),this.filteredPrompts=e},openCreateModal(){this.editingPrompt=null,this.formData={title:"",content:"",category:"general"},this.showModal=!0},openEditModal(e){this.editingPrompt=e,this.formData={title:e.title,content:e.content,category:e.category||"general"},this.showModal=!0},closeModal(){this.showModal=!1,this.editingPrompt=null,this.formData={title:"",content:"",category:"general"}},async savePrompt(){var e,a;if(this.formData.title.trim())if(this.formData.content.trim()){this.saving=!0;try{const i=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_save_prompt",nonce:chatprData.nonce,project_id:this.projectId||"",prompt_id:(null==(e=this.editingPrompt)?void 0:e.id)||"",title:this.formData.title,content:this.formData.content,category:this.formData.category})}),s=await i.json();s.success?(t(this.editingPrompt?"Prompt updated successfully":"Prompt created successfully","success",2e3),this.closeModal(),this.loadPrompts()):t((null==(a=s.data)?void 0:a.message)||"Failed to save prompt","error")}catch(i){console.error("Save error:",i),t("Failed to save prompt","error")}finally{this.saving=!1}}else t("Please enter prompt content","error");else t("Please enter a title","error")},async deletePrompt(e){var a;if(confirm("Are you sure you want to delete this prompt? This action cannot be undone."))try{const i=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_delete_prompt",nonce:chatprData.nonce,prompt_id:e,project_id:this.projectId||""})}),s=await i.json();s.success?(t("Prompt deleted successfully","success",2e3),this.prompts=this.prompts.filter(t=>t.id!==e),this.filterPrompts()):t((null==(a=s.data)?void 0:a.message)||"Failed to delete prompt","error")}catch(i){console.error("Delete error:",i),t("Failed to delete prompt","error")}},async enhancePrompt(){var e;if(this.formData.content.trim()){this.enhancing=!0;try{const a=await fetch(chatprData.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"chatpr_enhance_prompt",nonce:chatprData.nonce,prompt:this.formData.content})}),i=await a.json();i.success?(this.formData.content=i.data.enhanced||i.data.text,t("Prompt enhanced successfully","success",2e3)):t((null==(e=i.data)?void 0:e.message)||"Failed to enhance prompt","error")}catch(a){console.error("Enhance error:",a),t("Failed to enhance prompt","error")}finally{this.enhancing=!1}}else t("Please enter prompt content first","error")},usePrompt(e){navigator.clipboard.writeText(e.content).then(()=>{t("Prompt copied to clipboard","success",2e3)}).catch(()=>{t("Failed to copy prompt","error")})},getCategoryLabel:e=>({general:"General",code:"Code Generation",content:"Content Writing",analysis:"Analysis"}[e]||e),getCategoryColor(e){const t={general:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",code:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300",content:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",analysis:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300"};return t[e]||t.general},extractVariables(e){const t=/\{\{(\w+)\}\}/g,a=[];let i;for(;null!==(i=t.exec(e));)a.includes(i[1])||a.push(i[1]);return a},truncateText:(e,t=150)=>e?e.length>t?e.substring(0,t)+"...":e:""}))}),window.Alpine=e,a(),s||(s=new i),window.VPTheme=s,r||(r=new o),window.VPShortcuts=r;window._alpineStarted||(window._alpineStarted=!0,e.start());
